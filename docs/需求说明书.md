# 个人密码管理App需求说明书

## 1. 项目概述

### 1.1 项目名称
个人密码管理器 (Personal Password Manager)

### 1.2 项目目标
基于 Electron + React + TypeScript 实现跨平台桌面密码管理应用（以 macOS 为主），提供安全、便捷的本地密码管理功能，无需服务器端支持。

### 1.3 项目特点
- 跨平台桌面应用（macOS/Windows/Linux）
- 本地存储，无服务器依赖
- 敏感字段加密存储（AES-256-CBC）
- 支持 JSON 导入导出与加密 ZIP 备份
- 简洁高效的界面设计（Ant Design）
- 快速开发，快速交付

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 密码存储
- **功能描述**：用户可以存储网站/应用的用户名和密码
- **字段要求**：
  - 网站名称/应用名称
  - 用户名/邮箱
  - 密码
  - 网址（可选）
  - 备注（可选）
  - 分类标签
  - 创建时间
  - 最后修改时间
- ✅ **密码历史记录**：记录密码修改历史，支持查看旧密码
- ✅ **密码隐私保护**：密码列表默认隐藏，点击眼睛图标显示/隐藏
（变更）移除“多账号密码存储”，统一为“单账号=一条密码条目”。如需记录多个账号或说明性文本，请使用“便笺”模块。

#### 2.1.2 密码生成器
- **功能描述**：生成强密码
- **功能要求**：
  - 密码长度可调（4-128位）
  - 包含大写字母、小写字母、数字、特殊字符
  - 可自定义字符集
  - 密码强度评估
  - 一键复制功能

#### 2.1.3 搜索与分类
- **功能描述**：快速查找和管理密码
- **功能要求**：
  - 按名称搜索
  - 按分类筛选
  - 按标签筛选
  - 最近使用记录
  - 收藏功能
- ✅ **分组管理**：支持创建、编辑、删除分组来组织密码
- ✅ **树形分组结构**：左侧显示树形分组列表，支持展开/折叠
- ✅ **分组名称唯一性**：系统自动检查分组名称，防止重复
- ✅ **"全部密码"选项**：提供查看所有密码的入口
- ✅ **分组颜色标识**：支持10种颜色标识不同分组
- ✅ **实时搜索**：输入时实时过滤密码列表
- ✅ **多字段搜索**：支持搜索网站名称、用户名、URL等字段

#### 2.1.4 数据导入导出
- ✅ **数据备份**：支持导出所有密码数据（加密格式）
- **数据恢复**：支持从备份文件恢复密码数据
- **格式转换**：支持从其他密码管理器导入数据

#### 2.1.5 界面交互
- ✅ **主界面布局**：左侧分组树形结构，右侧密码列表
- ✅ **模块切换**：顶栏模块标签（密码/便笺）统一切换与状态保持
- ✅ **时间显示**：标准中文格式 YYYY-MM-DD HH:mm:ss
- ✅ **隐私保护**：密码默认隐藏，点击眼睛图标显示/隐藏
- ✅ **历史记录查看**：支持查看密码修改历史，包括旧密码和新密码
- ⬜ **响应式设计**：基础适配已做，深度适配后续完善
- ⬜ **深色模式**：后续根据设置项扩展

#### 2.1.6 便笺模块（原“加密笔记”）
- **功能描述**：独立的自由文本记录模块，支持分组、置顶、归档，内容端侧加密，增删改查完整。
- **特性**：
  - 自由文本编辑，无模板约束
  - 独立分组体系（不与密码分组耦合）
  - 本地解密后搜索（服务端不可读内容）
  - 全局搜索中与密码分区展示
  - 与密码条目完全解耦，无双向引用

#### 2.1.7 模块切换与便捷流程
- 顶栏导航：提供 `密码` 与 `便笺` 两个一级模块标签，当前模块高亮，点击无刷新切换；右侧包含 `快速新建`、`命令面板`、`设置`。
- 全局搜索：顶栏输入框支持跨模块搜索；结果以模块分区展示。
- 快捷操作：
  - 快速新建：在任一模块唤起，默认新建当前模块实体，可选择目标分组
  - 命令面板：统一入口，支持“新建、移动到分组、置顶/归档、批量删除”等命令
  - 快捷键：`Cmd+1/2` 切模块，`Cmd+F` 聚焦搜索，`Cmd+N` 快速新建，`Cmd+K` 命令面板
- 统一工具栏：内容区顶部提供搜索、筛选、排序、批量操作、`+ 新建`；密码与便笺保持一致的交互范式。

### 2.2 安全功能

#### 2.2.1 数据加密
**实现**：Node.js crypto 的 PBKDF2（salt='salt'，10000次）派生 32 字节密钥；AES-256-CBC 加密（随机 IV，存储格式 `ivHex:cipherHex`）
- **加密范围**：`passwords.password`、`password_history.old_password/new_password`、`secure_records.content_ciphertext`
- **说明**：暂未实现数据库文件级加密（SQLCipher）；如需可在后续版本迭代


#### 2.2.2 会话与隐私
- 密码强度指示：生成器中提供基础强度提示
- 自动锁定、防截屏、安全输入、内存保护：当前代码未实现，规划后续版本支持

### 2.3 数据管理

#### 2.3.1 导入导出
- **功能描述**：数据的备份和恢复
- **支持格式**：
  - ✅ JSON 格式导入/导出
  - ✅ 加密 ZIP 备份包导出/导入（需设置导出密码）

### 2.4 用户体验

#### 2.4.1 界面设计
- **设计原则**：
  - 简洁明了的界面
  - 暗色/亮色主题切换
  - 响应式设计
  - 无障碍访问支持

#### 2.4.2 操作便捷性
- **功能要求**：
  - 一键复制密码
  - 自动填充提示
  - 快捷键支持（Mac端）

## 3. 非功能需求

### 3.1 性能要求
- **启动时间**：应用启动时间 < 3秒
- **响应时间**：界面操作响应时间 < 500ms
- **搜索性能**：1000条密码记录搜索时间 < 1秒
- **内存占用**：正常运行时内存占用 < 200MB
- **存储空间**：数据文件大小合理，支持压缩存储

### 3.2 兼容性要求
- **操作系统**：macOS 12.0及以上版本
- **架构支持**：Intel和Apple Silicon芯片

### 3.3 安全要求
- **加密算法**：AES-256加密
- **密钥管理**：PBKDF2密钥派生
- **安全标准**：符合OWASP密码管理安全指南
- **数据保护**：本地数据加密存储

### 3.4 可用性要求
- **界面语言**：中文（简体）
- **学习成本**：新用户5分钟内掌握基本操作
- **操作效率**：常用操作1-2步完成
- **错误处理**：友好的错误提示和恢复机制

## 4. 用户场景

### 4.1 主要用户群体
- 个人用户：管理个人网站和应用密码
- 安全意识用户：需要本地存储的密码管理

### 4.2 使用场景

#### 4.2.1 日常使用场景
✅ **场景1：快速查找密码**
1. 用户打开应用，输入主密码解锁
2. 在搜索框输入网站名称
3. 系统实时显示匹配的密码列表
4. 点击密码项查看详细信息

✅ **场景2：添加新密码**
1. 点击"添加密码"按钮
2. 填写网站名称、用户名、密码
3. 选择分组（如"社交媒体"）
4. 点击保存，系统自动加密存储

✅ **场景3：分组管理**
1. 用户在左侧分组树形结构中查看所有分组
2. 点击"添加分组"创建新分组
3. 系统检查分组名称唯一性，防止重复
4. 选择颜色标识，分组创建成功

✅ **场景4：密码历史查看**
1. 选择一个密码记录
2. 点击"历史记录"按钮
3. 查看密码修改历史，包括时间、旧密码、新密码
4. 使用隐私按钮控制密码显示/隐藏

#### 4.2.2 安全场景
✅ **场景5：隐私保护**
1. 密码列表默认显示为••••••••
2. 点击眼睛图标显示真实密码
3. 再次点击隐藏密码，保护隐私

**场景6：自动锁定**
1. 用户离开电脑，应用闲置5分钟
2. 应用自动锁定，需要重新输入主密码
3. 保护数据安全

**场景7：密码生成**
1. 用户注册新网站需要密码
2. 打开密码生成器
3. 设置密码规则（长度、字符类型）
4. 生成强密码并保存

#### 4.2.3 数据管理场景
✅ **场景8：便笺管理**

**用户故事**：作为项目运维，我希望以自由文本记录多个系统的账号说明、操作步骤与上下文信息，并确保内容与密码同级别加密与分组管理。

**操作流程**：
1. 在“便笺”模块点击“新建便笺”，输入标题与正文（自由文本）。
2. 选择记录分组（与密码分组独立），可设置“置顶/归档”。
3. 保存后内容以密文存储，服务端不可读；搜索在本地解密后进行。
4. 在全局搜索时，密码与便笺分区显示；点击进入编辑或查看。

**价值体现**：
- 文本更灵活，适合多账号说明/操作手册/共享信息记录。
- 安全边界清晰：内容端侧加密，访问受控。
- 与密码条目解耦，避免模型混乱。

1. **数据备份和恢复**：通过导入导出功能支持可以支持所有数据的全量以及增量恢复

## 5. 约束条件

### 5.1 技术约束
- **框架**：Electron 27 + React 18 + TypeScript 5
- **UI**：Ant Design 5
- **数据存储**：SQLite（better-sqlite3）
- **构建**：Webpack 5
- **加密**：Node.js crypto（PBKDF2 + AES-256-CBC）

### 5.2 安全约束
- **数据存储**：仅限本地存储，禁止网络传输
- **加密标准**：使用行业标准的加密算法
- **密钥管理**：密钥不明文存储，派生生成
- **权限控制**：遵循 Electron 安全最佳实践

### 5.3 用户体验约束
- **界面设计**：遵循macOS设计规范
- **操作流程**：简化操作步骤，提高效率
- **响应速度**：界面操作必须流畅无卡顿
- **错误处理**：提供清晰的错误提示和解决方案

### 5.4 开发约束
- **开发工具**：Xcode + Swift
- **测试要求**：单元测试覆盖率 > 80%
- **代码质量**：遵循Swift编码规范
- **文档要求**：提供完整的开发文档

## 6. 验收标准

### 6.1 功能验收

#### 6.1.1 功能验收标准
✅ **基础功能验收**
- [x] 应用能够正常启动和关闭
- [x] 主密码设置和验证功能正常
- [x] 密码的增删改查功能完整
- [x] 搜索功能能够正确过滤结果
- [x] 分组管理功能完整（创建、编辑、删除）
- [x] 分组名称唯一性检查正常工作
- [x] 树形分组结构显示正确，支持展开/折叠
- [x] "全部密码"选项功能正常
- [x] 分组颜色标识功能正常

✅ **密码管理验收**
- [x] 密码生成器能够生成符合规则的密码
- [x] 密码强度检测功能准确
- [x] 密码历史记录功能正常
- [x] 密码隐私按钮功能正常（显示/隐藏切换）
- [x] 时间显示格式正确（YYYY-MM-DD HH:mm:ss）
 
✅ **便笺管理验收**
- [x] 便笺分组管理完整（创建/重命名/删除/颜色设置/树形层级）
- [x] 便笺列表展示完整（标题/分组/置顶/归档/更新时间）
- [x] 便笺编辑器支持自由文本，保存、取消与分组选择正常
- [x] 置顶/归档筛选与排序功能正常
- [x] 全局搜索中便笺与密码分区展示正确

✅ **模块切换与便捷流程验收**
- [x] 顶栏模块切换正常（密码/便笺）且状态保持
- [x] 快速新建与命令面板可在任意模块唤起并正确执行
- [x] 快捷键可用：`Cmd+1/2` 切模块、`Cmd+F` 搜索、`Cmd+N` 新建、`Cmd+K` 面板

✅ **安全功能验收**
- [x] 数据加密存储功能正常
- [x] 自动锁定功能按预期工作
- [x] 防截屏功能生效
- [x] 主密码验证机制安全可靠

#### 6.1.2 性能验收标准
- [x] 应用启动时间 < 3秒
- [x] 搜索响应时间 < 500ms
- [x] 密码列表加载流畅
- [x] 内存使用合理（< 100MB）

#### 6.1.3 用户体验验收标准
- [x] 界面布局合理，操作直观
- [x] 错误提示清晰友好
- [x] 键盘快捷键功能正常
- [x] 深色模式适配良好

### 6.2 性能验收
- [ ] 应用启动时间 < 3秒
- [ ] 界面响应时间 < 500ms
- [ ] 1000条记录搜索时间 < 1秒
- [ ] 内存占用 < 200MB
- [ ] 无明显内存泄漏

### 6.3 安全验收
- [ ] 数据文件加密存储
- [ ] 通过安全渗透测试
- [ ] 密钥管理符合安全标准
- [ ] 敏感数据及时清理
- [ ] 防止截屏和录屏

### 6.4 用户体验验收
- [ ] 界面设计符合macOS规范
- [ ] 新用户5分钟内掌握基本操作
- [ ] 常用操作1-2步完成
- [ ] 错误提示清晰友好
- [ ] 支持深色/浅色模式

### 6.5 兼容性验收
- [ ] 支持macOS 12.0及以上版本
- [ ] 支持Intel和Apple Silicon芯片
- [ ] 支持Touch ID/Face ID设备
- [ ] 通过App Store审核标准

## 7. 项目里程碑

### 7.1 开发阶段

#### 阶段1：基础架构（已完成）
✅ **时间**：第1-2周
- [x] 项目初始化和环境搭建
- [x] Electron + React + TypeScript 架构搭建
- [x] 数据库设计和实现（SQLite + better-sqlite3）
- [x] 基础UI框架搭建（Ant Design）
- [x] 主进程和渲染进程通信机制

#### 阶段2：核心功能（已完成）
✅ **时间**：第3-4周
- [x] 主密码设置和验证
- [x] 密码增删改查功能
- [x] 数据加密存储（AES-256）
- [x] 密码生成器实现
- [x] 搜索功能实现

#### 阶段3：高级功能（已完成）
✅ **时间**：第5-6周
- [x] 分组管理功能（创建、编辑、删除）
- [x] 分组名称唯一性检查
- [x] 树形分组结构显示
- [x] 分组颜色标识系统
- [x] 密码历史记录功能
- [x] 隐私保护按钮（密码显示/隐藏）
- [x] 时间显示格式优化

#### 阶段4：安全和优化（进行中）
✅ **时间**：第7-8周
- [x] 性能优化
- [x] 错误处理完善
- [ ] 加密压缩导出（待完善）
- [ ] 深色模式与自动锁定（规划中）

### 7.2 测试阶段

#### 阶段5：功能测试（进行中）
✅ **时间**：第9周
- [x] 单元测试编写
- [x] 集成测试
- [x] 用户界面测试
- [x] 安全功能测试
- [ ] 性能测试（待完善）

#### 阶段6：用户测试（待开始）
**时间**：第10周
- [ ] 内部用户测试
- [ ] Bug修复和优化
- [ ] 用户体验改进
- [ ] 文档完善

### 7.3 发布阶段

#### 阶段7：发布准备（待开始）
**时间**：第11-12周
- [ ] 应用签名和公证
- [ ] 安装包制作
- [ ] 发布文档编写
- [ ] 用户手册制作
- [ ] 正式发布

### 7.4 维护阶段

#### 阶段8：后续维护（待开始）
**时间**：发布后
- [ ] 用户反馈收集
- [ ] Bug修复
- [ ] 功能迭代
- [ ] 安全更新

## 8. 风险评估

### 8.1 技术风险
- **风险**：Electron 应用体积与内存占用
- **影响**：中等
- **缓解措施**：代码分割、资源优化、内存管理

### 8.2 安全风险
- **风险**：加密实现不当导致数据泄露
- **影响**：高
- **缓解措施**：使用系统原生加密API，进行安全审计

### 8.3 用户体验风险
- **风险**：界面设计不符合用户习惯
- **影响**：中等
- **缓解措施**：遵循macOS设计规范，进行用户测试

### 8.4 时间风险
- **风险**：开发时间超出预期
- **影响**：中等
- **缓解措施**：合理规划开发进度，优先核心功能

---

**文档版本**：v2.2  
**更新日期**：2025年11月  
**最后更新**：根据实际开发进度更新功能实现状态和项目里程碑  
**负责人**：开发团队  
**审核人**：产品经理
